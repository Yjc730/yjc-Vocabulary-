/* ============ Base ============ */
:root{
  --bg:#f6f7fb;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --line:#e5e7eb;
  --soft:#f1f5f9;

  --primary:#3f5bff;
  --primary-weak:#eef1ff;

  --shadow: 0 18px 45px rgba(15, 23, 42, .08);
  --radius: 18px;
  --radius2: 24px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC",
               "PingFang TC","Microsoft JhengHei", Arial, sans-serif;
  color:var(--text);
  background: radial-gradient(1200px 500px at 50% -200px, rgba(63,91,255,.18), transparent 60%),
              var(--bg);
}

/* links / selection */
::selection{ background: rgba(63,91,255,.25); }

.hidden{ display:none !important; }

/* ============ Layout ============ */
.container{
  max-width: 1120px;
  margin: 0 auto;
  padding: 26px 18px 70px;
}

/* ============ Topbar ============ */
.topbar{
  position: sticky;
  top: 0;
  z-index: 50;
  background: rgba(246,247,251,.78);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(229,231,235,.9);
}
.topbar-inner{
  max-width: 1120px;
  margin: 0 auto;
  padding: 14px 18px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 18px;
}

.brand{
  display:flex;
  align-items:center;
  gap: 12px;
  min-width: 220px;
}
.logo{
  width: 46px;
  height: 46px;
  border-radius: 16px;
  display:grid;
  place-items:center;
  font-weight: 900;
  color:#fff;
  background: linear-gradient(135deg, #3f5bff, #6f7bff);
  box-shadow: 0 10px 28px rgba(63,91,255,.28);
}
.title{
  font-size: 18px;
  font-weight: 900;
  letter-spacing: .2px;
  line-height: 1.1;
}
.subtitle{
  margin-top: 4px;
  font-size: 13px;
  color: var(--muted);
}

/* ============ Tabs ============ */
.tabs{
  display:flex;
  gap: 10px;
  align-items:center;
  flex-wrap: wrap;
}
.tab{
  border: 1px solid rgba(148,163,184,.35);
  background: rgba(255,255,255,.75);
  color: #64748b;
  padding: 10px 18px;
  border-radius: 999px;
  font-weight: 800;
  cursor:pointer;
  transition: .18s ease;
  box-shadow: 0 1px 0 rgba(15,23,42,.04);
}
.tab:hover{
  transform: translateY(-1px);
  border-color: rgba(63,91,255,.35);
}
.tab.is-active{
  color: var(--text);
  border-color: rgba(63,91,255,.35);
  background: var(--primary-weak);
}

/* ============ Typography & helpers ============ */
h2{
  margin: 0;
  font-size: 28px;
  font-weight: 900;
  letter-spacing: .2px;
}
h3{
  margin: 0;
  font-size: 18px;
  font-weight: 900;
}
.hint{
  color: var(--muted);
  font-size: 14px;
  font-weight: 700;
}
.muted{ color: var(--muted); }

.row{ display:flex; align-items:center; }
.row.between{ justify-content:space-between; }
.row.wrap{ flex-wrap: wrap; }
.row.gap{ gap: 12px; }
.row.between.gap{ gap: 12px; }
.grow{ flex: 1; min-width: 240px; }

/* ============ Panels ============ */
.panel{
  margin-top: 16px;
  background: transparent;
}
.panelInner{
  margin-top: 14px;
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  padding: 18px 18px 16px;
  box-shadow: var(--shadow);
}
.hr{
  border:0;
  height:1px;
  background: rgba(229,231,235,.9);
  margin: 18px 0;
}

/* ============ Fields ============ */
.field{
  display:flex;
  flex-direction: column;
  gap: 8px;
  min-width: 210px;
}
.field label{
  font-size: 14px;
  color: var(--muted);
  font-weight: 800;
}
input, select{
  height: 52px;
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,.25);
  background: rgba(255,255,255,.92);
  padding: 0 16px;
  font-size: 16px;
  outline: none;
  transition: .15s ease;
  box-shadow: 0 1px 0 rgba(15,23,42,.03);
}
input:focus, select:focus{
  border-color: rgba(63,91,255,.55);
  box-shadow: 0 0 0 4px rgba(63,91,255,.12);
}
input::placeholder{ color: #9aa4b2; font-weight: 600; }

.grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
.span2{ grid-column: 1 / -1; }

@media (max-width: 820px){
  .grid{ grid-template-columns: 1fr; }
  .span2{ grid-column: auto; }
}

/* ============ Buttons ============ */
.btn{
  height: 52px;
  padding: 0 18px;
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,.25);
  background: #fff;
  color: var(--text);
  font-weight: 900;
  cursor:pointer;
  transition: .15s ease;
  box-shadow: 0 8px 22px rgba(15,23,42,.06);
}
.btn:hover{ transform: translateY(-1px); }
.btn:active{ transform: translateY(0px); }

.btn-primary{
  border-color: rgba(63,91,255,.25);
  background: linear-gradient(135deg, #3f5bff, #566bff);
  color: #fff;
}
.btn-soft{
  background: var(--primary-weak);
  border-color: rgba(63,91,255,.25);
}
.btn-ghost{
  background: rgba(255,255,255,.7);
}

/* message text */
.msg{
  font-size: 14px;
  color: var(--muted);
  font-weight: 800;
  padding-top: 2px;
}

/* ============ Home cards (Quizlet-ish cover cards) ============ */
.cardsWrap{
  margin-top: 16px;
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}
@media (max-width: 980px){ .cardsWrap{ grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 640px){ .cardsWrap{ grid-template-columns: 1fr; } }

.setCard{
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  box-shadow: var(--shadow);
  padding: 18px;
  cursor:pointer;
  transition: .16s ease;
  position: relative;
  overflow:hidden;
}
.setCard:hover{
  transform: translateY(-2px);
  border-color: rgba(63,91,255,.25);
}
.setCard::before{
  content:"";
  position:absolute;
  inset:-2px;
  background: radial-gradient(420px 180px at 30% -40px, rgba(63,91,255,.18), transparent 60%);
  pointer-events:none;
}
.setCardHead{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 12px;
  position: relative;
}
.setTitle{
  font-size: 20px;
  font-weight: 950;
  letter-spacing: .2px;
}
.setSub{
  margin-top: 6px;
  color: var(--muted);
  font-weight: 800;
  font-size: 14px;
}
.pill{
  display:inline-flex;
  align-items:center;
  gap: 6px;
  padding: 8px 12px;
  border-radius: 999px;
  font-weight: 900;
  font-size: 13px;
  color: #1f2a44;
  background: rgba(63,91,255,.10);
  border: 1px solid rgba(63,91,255,.20);
  position: relative;
  white-space: nowrap;
}
.setMeta{
  margin-top: 14px;
  color: var(--muted);
  font-weight: 850;
  display:flex;
  gap: 14px;
  flex-wrap: wrap;
  position: relative;
}
.setActions{
  margin-top: 14px;
  display:flex;
  gap: 12px;
  position: relative;
}

/* ============ Study ============ */
.todayBox{
  margin-top: 14px;
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  padding: 14px 16px;
  box-shadow: var(--shadow);
}
.todayText{ font-weight: 950; }
.bar{
  margin-top: 10px;
  height: 12px;
  background: #eef2ff;
  border: 1px solid rgba(63,91,255,.12);
  border-radius: 999px;
  overflow:hidden;
}
.barFill{
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #3f5bff, #6f7bff);
  border-radius: 999px;
}

.empty{
  margin-top: 14px;
  background: rgba(255,255,255,.75);
  border: 1px dashed rgba(148,163,184,.35);
  border-radius: var(--radius2);
  padding: 18px;
  color: var(--muted);
  font-weight: 900;
}

.review{
  margin-top: 14px;
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  padding: 18px;
  box-shadow: var(--shadow);
}
.progress{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom: 10px;
  font-weight: 950;
  color: var(--muted);
}

.flashcard{
  width: 100%;
  border: 1px solid rgba(148,163,184,.22);
  background: #fff;
  border-radius: 22px;
  padding: 0;
  cursor:pointer;
  box-shadow: 0 22px 55px rgba(15,23,42,.07);
  overflow:hidden;
  position: relative;
}
.flashcardInner{
  position: relative;
  width: 100%;
  min-height: 320px;
  transform-style: preserve-3d;
  transition: transform .45s ease;
}
.flashcard.is-flipped .flashcardInner{
  transform: rotateY(180deg);
}

.face{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction: column;
  align-items:center;
  justify-content:center;
  padding: 26px;
  backface-visibility: hidden;
}
.face.back{
  transform: rotateY(180deg);
  background: radial-gradient(500px 200px at 50% -60px, rgba(63,91,255,.14), transparent 60%),
              #fff;
}

.big{
  font-size: 56px;
  font-weight: 1000;
  letter-spacing: .2px;
  line-height: 1.05;
  text-align:center;
}
.big2{
  font-size: 32px;
  font-weight: 1000;
  text-align:center;
  line-height: 1.2;
}
#frontSub{
  margin-top: 8px;
  font-size: 18px;
  font-weight: 900;
  color: var(--muted);
}
.meta{
  margin-top: 10px;
  font-size: 15px;
  font-weight: 850;
  color: var(--muted);
  text-align:center;
  max-width: 720px;
}
.tap{
  margin-top: 14px;
  font-size: 13px;
  font-weight: 900;
  color: #94a3b8;
}

.rateRow{
  display:flex;
  gap: 12px;
  margin-top: 16px;
  justify-content:center;
}
.rateRow .btn{
  min-width: 140px;
}

/* ============ Table ============ */
.tableWrap{
  margin-top: 16px;
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  box-shadow: var(--shadow);
  overflow:hidden;
}
.table{
  width:100%;
  border-collapse: collapse;
}
.table thead th{
  text-align:left;
  font-size: 14px;
  color: var(--muted);
  font-weight: 950;
  padding: 14px 16px;
  background: rgba(241,245,249,.9);
  border-bottom: 1px solid rgba(229,231,235,.9);
}
.table tbody td{
  padding: 14px 16px;
  border-bottom: 1px solid rgba(229,231,235,.8);
  font-weight: 800;
}
.table tbody tr:hover td{
  background: rgba(63,91,255,.04);
}
.table .actions{
  display:flex;
  gap: 10px;
}

/* ============ Notebook (單字薄) ============ */
.notebook{
  margin-top: 16px;
  background: var(--card);
  border: 1px solid rgba(229,231,235,.9);
  border-radius: var(--radius2);
  box-shadow: var(--shadow);
  padding: 16px;
}
.nb-head{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap: 12px;
  margin-bottom: 10px;
}
.nb-title{
  font-size: 16px;
  font-weight: 1000;
}
.nb-sub{
  font-size: 13px;
  color: var(--muted);
  font-weight: 850;
}

.nb-group{
  margin-top: 14px;
}
.nb-groupTitle{
  font-weight: 1000;
  font-size: 15px;
  margin: 10px 0;
  color: #111827;
}
.nb-row{
  display:grid;
  grid-template-columns: 1.2fr 1fr 1.6fr;
  gap: 12px;
  padding: 12px 12px;
  border: 1px solid rgba(229,231,235,.9);
  border-radius: 16px;
  background: #fff;
  margin-bottom: 10px;
}
.nb-en{ display:flex; flex-direction:column; gap: 4px; }
.nb-term{ font-size: 18px; font-weight: 1000; }
.nb-pos{ font-size: 13px; font-weight: 900; color: var(--muted); }
.nb-zh{
  font-size: 16px;
  font-weight: 950;
  color: #0b1220;
  align-self:center;
}
.nb-ex{
  font-size: 14px;
  font-weight: 850;
  color: var(--muted);
  align-self:center;
}
@media (max-width: 860px){
  .nb-row{ grid-template-columns: 1fr; }
  .nb-zh,.nb-ex{ align-self: start; }
}

/* ============ Dialog ============ */
dialog.dialog{
  border: none;
  padding: 0;
  background: transparent;
}
dialog::backdrop{
  background: rgba(15,23,42,.35);
  backdrop-filter: blur(3px);
}
.dialogCard{
  width: min(860px, calc(100vw - 24px));
  background: #fff;
  border: 1px solid rgba(229,231,235,.9);
  border-radius: 22px;
  box-shadow: 0 35px 90px rgba(15,23,42,.18);
  padding: 16px;
}

/* ============ Print (只印單字簿 + 顯示中文) ============ */
@media print{
  :root{ --bg:#fff; }
  body{
    background:#fff !important;
  }
  .topbar, .tabs, #tab-home, #tab-study, #tab-add, #tab-backup,
  #tableView, .btn, button, select, input, .hint, .msg{
    display:none !important;
  }

  /* 強制顯示單字簿 */
  #tab-library{ display:block !important; }
  #notebookView, .notebook{ display:block !important; }
  #notebookView.hidden{ display:block !important; }

  .container{
    max-width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
  }
  .notebook{
    border:none !important;
    box-shadow:none !important;
    padding: 0 !important;
  }
  .nb-row{
    break-inside: avoid;
    page-break-inside: avoid;
    border: 1px solid #d1d5db !important;
  }
  .nb-zh{ color:#000 !important; }
}

/* ===== 列印修正：確保中文顯示 ===== */
@media print {
  .nbTable td,
  .nbTable th {
    color: #000 !important;
    opacity: 1 !important;
  }

  .nbTable td:nth-child(3) {
    font-weight: 500;
  }
}
